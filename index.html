<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>IRL Life System</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0b0014" />
  <link rel="manifest" href="manifest.json" />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root { --glow: #4fc3ff; }
    body { margin:0; font-family:'Orbitron',sans-serif; background:radial-gradient(circle at top,#12001f,#040008); color:#e6e6ff; }
    .container { max-width:430px; margin:30px auto; background:rgba(15,0,30,0.9); border-radius:18px; box-shadow:0 0 30px var(--glow); padding:20px; }
    h1 { text-align:center; color:var(--glow); margin-bottom:8px; }
    .level { text-align:center; font-size:1.1em; margin-bottom:12px; }
    .panel { border:1px solid var(--glow); border-radius:14px; padding:12px; margin-bottom:14px; }
    .stat, .quest { display:flex; justify-content:space-between; margin:6px 0; align-items:center; }
    button { background:linear-gradient(135deg,var(--glow),#ffffff); border:none; border-radius:10px; color:#000; padding:6px 12px; font-family:inherit; cursor:pointer; }
    button:disabled { opacity:0.4; cursor:not-allowed; }
    .system-msg { text-align:center; font-size:0.85em; color:var(--glow); margin-top:10px; }
    .log { max-height:120px; overflow-y:auto; font-size:0.75em; background:rgba(0,0,0,0.4); padding:6px; border-radius:8px; margin-top:10px; }
    .notification { position:fixed; top:20px; right:20px; background:rgba(0,0,0,0.85); color:#fff; padding:12px 18px; border-radius:10px; box-shadow:0 0 20px var(--glow); font-weight:600; display:none; z-index:1000; }
  </style>
</head>
<body>

<div class="container">
  <h1>„Äê SYSTEM „Äë</h1>
  <div class="level" id="level"></div>
  <div class="system-msg" id="title"></div>

  <div class="panel">
    <strong>STATS</strong>
    <div class="stat">STR <span id="str"></span></div>
    <div class="stat">END <span id="end"></span></div>
    <div class="stat">AGI <span id="agi"></span></div>
    <div class="stat">INT <span id="int"></span></div>
    <div class="stat">WIL <span id="wil"></span></div>
  </div>

  <div class="panel">
    <strong>DAILY CORE QUESTS</strong>
    <div class="quest">Workout <button id="q-workout" onclick="completeQuest('workout','str')">CLEAR</button></div>
    <div class="quest">Study <button id="q-study" onclick="completeQuest('study','int')">CLEAR</button></div>
    <div class="quest">Meditation <button id="q-meditation" onclick="completeQuest('meditation','wil')">CLEAR</button></div>
  </div>

  <div class="panel">
    <strong>MARTIAL ARTS DRILLS (BONUS)</strong>
    <div class="quest">Kyokushin <button onclick="completeBonus('str')">CLEAR</button></div>
    <div class="quest">Muay Thai <button onclick="completeBonus('end')">CLEAR</button></div>
    <div class="quest">Boxing Footwork <button onclick="completeBonus('agi')">CLEAR</button></div>
    <div class="quest">Wing Chun <button onclick="completeBonus('agi')">CLEAR</button></div>
    <div class="quest">Judo <button onclick="completeBonus('str')">CLEAR</button></div>
    <div class="quest">Jeet Kune Do <button onclick="completeBonus('wil')">CLEAR</button></div>
    <div class="quest">Sword Shadow Practice <button onclick="completeBonus('int')">CLEAR</button></div>
  </div>

  <div class="panel">
  <strong>WEEKLY BOSS</strong>
  <div class="system-msg" id="boss"></div>

  <div class="quest">Push-ups 
    <button id="boss-task-pushups" onclick="completeBossTask('pushups')">CLEAR</button>
  </div>
  <div class="quest">Squats 
    <button id="boss-task-squats" onclick="completeBossTask('squats')">CLEAR</button>
  </div>
  <div class="quest">Run 
    <button id="boss-task-run" onclick="completeBossTask('run')">CLEAR</button>
  </div>

  <button id="attemptBossBtn" onclick="attemptBoss()">ATTEMPT BOSS</button>
  </div>

  <div class="system-msg" id="msg"></div>
  <div class="system-msg" id="streakBox"></div>

  <div class="panel">
    <strong>SKILLS</strong>
    <div class="system-msg" id="skills"></div>
  </div>

  <div class="panel">
  <strong>ACHIEVEMENTS</strong>
  <div class="system-msg" id="achievements"></div>
  </div>
  
  <div class="panel">
    <strong>PENALTY ZONE</strong>
    <div class="system-msg" id="penalty"></div>
  </div>

  <div class="panel">
    <strong>LOG</strong>
    <div class="log" id="history"></div>
  </div>
</div>

<div class="notification" id="notification"></div>

<script>
/* ================= CORE STATE ================= */
var baseStats = { str:1, end:1, agi:1, int:1, wil:1 };
var level = 1, exp = 0, expMax = 100;
var streak = 0, multiplier = 1;

var dailyQuests = { workout:false, study:false, meditation:false };

var bossDefeated = false;
var bossAttemptedThisWeek = localStorage.getItem('bossAttemptedThisWeek') === 'true';
var bossTasks = JSON.parse(localStorage.getItem('bossTasks')) || { pushups:false, squats:false, run:false };
var lastBossDate = localStorage.getItem('lastBossDate') || null;
var lastResetDate = localStorage.getItem('lastResetDate') || null;
var lastDayCompletedAll = false;

var skillFlags = {};
var shadowMonarchUnlocked = false;

/* ===== ACHIEVEMENTS ===== */
var achievements = {};

/* ================= BOSS DATA ================= */
var bossTask = {
  name: "Weekly Boss: Shadow Fiend",
  description:
    "Complete all tasks to defeat the Shadow Fiend:\n" +
    "- 100 Push-ups\n" +
    "- 100 Squats\n" +
    "- 5 km Run"
};

/* ================= SAVE / LOAD ================= */
function saveGame(){
  localStorage.setItem('irlSystemSave', JSON.stringify({
    baseStats,
    level,
    exp,
    expMax,
    streak,
    multiplier,
    dailyQuests,
    bossDefeated,
    skillFlags,
    shadowMonarchUnlocked,
    achievements,
    lastDayCompletedAll
  }));
  localStorage.setItem('bossTasks', JSON.stringify(bossTasks));
  localStorage.setItem('bossAttemptedThisWeek', bossAttemptedThisWeek ? 'true' : 'false');
  localStorage.setItem('lastBossDate', lastBossDate);
  localStorage.setItem('lastResetDate', lastResetDate);
}

function loadGame(){
  var raw = localStorage.getItem('irlSystemSave');
  if(!raw) return;
  var d = JSON.parse(raw);

  baseStats = d.baseStats || baseStats;
  level = d.level || level;
  exp = d.exp || exp;
  expMax = d.expMax || expMax;
  streak = d.streak || streak;
  multiplier = d.multiplier || multiplier;
  dailyQuests = d.dailyQuests || dailyQuests;
  bossDefeated = d.bossDefeated || false;
  skillFlags = d.skillFlags || {};
  shadowMonarchUnlocked = d.shadowMonarchUnlocked || false;
  achievements = d.achievements || {};
  lastDayCompletedAll = d.lastDayCompletedAll || false;
}

/* ================= NOTIFY / LOG ================= */
function notify(msg){
  var n = document.getElementById('notification');
  n.innerText = msg;
  n.style.display = 'block';
  setTimeout(()=>n.style.display='none',3500);
  log(msg);
}

function log(msg){
  var h = document.getElementById('history');
  h.innerHTML = `[${new Date().toLocaleTimeString()}] ${msg}<br>` + h.innerHTML;
}

/* ================= ACHIEVEMENTS ================= */
function unlockAchievement(id, title){
  if(achievements[id]) return;
  achievements[id] = title;
  notify('üèÜ ACHIEVEMENT UNLOCKED: ' + title);
  saveGame();
}

/* ================= DAILY RESET ================= */
function allDailyQuestsCompleted(){
  return Object.values(dailyQuests).every(Boolean);
}
  
function checkDailyResetByDate(){
  var today = new Date().toDateString();

  if (lastResetDate && lastResetDate !== today) {

    if (allDailyQuestsCompleted()) {
      streak++;
      multiplier = Math.min(multiplier + 0.1, 3);
      notify('STREAK CONTINUES ‚Üí ' + streak);

      if (streak === 7){
        unlockAchievement('streak7','Unbroken Will (7-Day Streak)');
      }
    } else {
      streak = 0;
      multiplier = 1;
      notify('STREAK BROKEN');
    }

    for (var q in dailyQuests){
      dailyQuests[q] = false;
      var btn = document.getElementById('q-' + q);
      if (btn) btn.disabled = false;
    }

    lastResetDate = today;
    saveGame();
  }
}
/* ================= WEEKLY BOSS RESET ================= */
function checkWeeklyBossReset(){
  var today = new Date();
  var onejan = new Date(today.getFullYear(), 0, 1);
  var weekNum = Math.ceil((((today - onejan)/86400000) + onejan.getDay() + 1)/7);

  if(lastBossDate != weekNum){
    bossDefeated = false;
    bossAttemptedThisWeek = false;
    bossTasks = { pushups:false, squats:false, run:false };
    lastBossDate = weekNum;
    notify('Weekly Boss is now available!');
    saveGame();
  }
}

/* ================= GAME LOGIC ================= */
function gainExp(amount) {
  exp += Math.floor(amount * multiplier);

  while (exp >= expMax) {
    exp -= expMax;
    level++;
    notify('LEVEL UP ‚Üí ' + level);

    // Update UI immediately to refresh glow
    updateUI();

    // Check Shadow Monarch unlock
    if (level >= 150 && !shadowMonarchUnlocked) {
      shadowMonarchUnlocked = true;
      skillFlags.shadowDominion = true;
      notify('BLACK HEART ACTIVATED. SHADOW MONARCH ASCENSION.');
      multiplier = Math.min(multiplier + 0.25, 3);
    }
  }

  // Save and refresh UI at the end
  saveGame();
  updateUI();
}

function completeQuest(id, stat){
  if(dailyQuests[id]) return;

  dailyQuests[id] = true;
  baseStats[stat]++;
  gainExp(20);

  unlockAchievement('firstQuest','First Step Taken');

  document.getElementById('q-' + id).disabled = true;
}

function completeBonus(stat){
  baseStats[stat]++;
  gainExp(10);
}

function completeBossTask(task){
  if(bossTasks[task]) return;

  bossTasks[task] = true;
  document.getElementById('boss-task-' + task).disabled = true;
  notify(task.toUpperCase() + ' completed');

  if(bossTasks.pushups && bossTasks.squats && bossTasks.run){
    unlockAchievement('bossTasks','Trial of Endurance');
  }

  saveGame();
  updateUI();
}
function getPhase(lv){
  if (lv < 5) {
    return { name: 'BLUE', color: '#4fc3ff' };
  }
  if (lv < 10) {
    return { name: 'ORANGE', color: '#ff9800' };
  }
  if (lv < 20) {
    return { name: 'RED', color: '#ff3b3b' };
  }
  return { name: 'PURPLE', color: '#b266ff' };
}
  
function attemptBoss(){
  if(bossAttemptedThisWeek) return;

  bossAttemptedThisWeek = true;

  if(
    bossTasks.pushups &&
    bossTasks.squats &&
    bossTasks.run &&
    baseStats.str >= 5 &&
    baseStats.end >= 5 &&
    baseStats.wil >= 5
  ){
    bossDefeated = true;
    gainExp(50);
    unlockAchievement('firstBoss','Shadow Fiend Slayer');
    notify('BOSS DEFEATED');
  } else {
    notify('Boss Failed. Train More.');
  }

  saveGame();
  updateUI();
}

/* ================= UI ================= */
function updateUI() {
  // LEVEL & TITLE
  document.getElementById('level').innerText = 'LEVEL ' + level + ' ‚Ä¢ EXP ' + exp + '/' + expMax;
  document.getElementById('title').innerText =
  shadowMonarchUnlocked ? 'SHADOW MONARCH' : 'HUMAN';

  // STATS
  for (var s in baseStats) {
    document.getElementById(s).innerText = baseStats[s];
  }

  // STREAK & MULTIPLIER
  document.getElementById('streakBox').innerText = 'STREAK ' + streak + ' ‚Ä¢ x' + multiplier.toFixed(1);

  // SKILLS
  document.getElementById('skills').innerText = Object.keys(skillFlags).join(' ‚Ä¢ ') || 'None';

  // PHASE COLOR
  var phase = getPhase(level);
  document.documentElement.style.setProperty('--glow', phase.color);

  // ACHIEVEMENTS (optional)
  document.getElementById('achievements').innerText = Object.values(achievements).join(' ‚Ä¢ ') || 'None';
  
  for (var t in bossTasks) {
  var b = document.getElementById('boss-task-' + t);
  if (b && bossTasks[t]) b.disabled = true;
  }
}

/* ================= INIT ================= */
loadGame();
checkDailyResetByDate();
checkWeeklyBossReset();
updateUI();
</script>
  
</body>

</html>













